# DDQC
## 简介
DDQC，按照拼音首字母读，懂的都懂，用`golang`写的，比较简陋，但是功能经过验证ok的。
## 如何使用
需要有`golang`环境，本人用的是`1.17`版本。需要根据实际使用人的信息，修改`api/configure.go`文件：
```Golang
const (
	UID = "xxxx" // 唯一编号
	LONGITUDE = "121.000000"  // 当前经度
	LATITUDE      = "31.00000"  // 当前纬度
	STATION_ID    = "xxx" // 配送站点编号
	CITY_NUMBER   = "0101"  // 城市编码
	API_VERSION   = "9.49.2"   // 接口版本号
	APP_VERSION   = "2.82.0" // 程序版本号
	APP_CLIENT_ID = "4"  // 程序客户端类型
	S_ID          = "xxxx" // session ID
	OPEN_ID       = "xxxx"  // 接入ID
	DEVICE_TOKEN  = "xxxx" // 客户端设备token
	ADDRESS_ID    = "xxxx"  // 送货地址ID
)
```
这些信息需要使用抓包工具`Fiddler/Charles`对`DD`的微信小程序进行抓包（注意处理https协议，需要安装证书），别抓APP，用的不是https协议，所以抓不到，微信小程序倒是用的https协议，抓起来没问题。`url`是`maicai.api.ddxq.mobi`，设置下过滤，免得信息太多被干扰。在`header`里面就有这些对应信息，改成你自己的就行了。<br>
剩下的工作，先安装好依赖：
```Shell
$ go mod tidy
```
然后在小程序里面先把要抢的菜加入购物车，等时间一到，就立刻运行：
```Shell
$ go run main.go
```
看到提示类似下面：
```Shell
  协程(1)发起请求，第2973次尝试......失败，原因：前方拥挤，请稍后再试...
  协程(1)发起请求，第2974次尝试......失败，原因：前方拥挤，请稍后再试...
  协程(1)发起请求，第2975次尝试......失败，原因：前方拥挤，请稍后再试...
  协程(1)发起请求，第2976次尝试......失败，原因：前方拥挤，请稍后再试...
  协程(1)发起请求，第2977次尝试......成功，请及时去微信小程序完成付款
```
去小程序直接到待支付订单里面去完成支付即可。<br>

## 注意事项
目前设置了两个协程进行工作，在`main.go`中：
```Golang
const (
	THREAD_NUM = 2 // 虚拟线程数量
)
```
可以根据需要修改，不过个人感觉2个足够了。<br>
程序并不保证一定能成功抢到，只是比人工的成功率更高一些罢了。仅做参考，请勿滥用。